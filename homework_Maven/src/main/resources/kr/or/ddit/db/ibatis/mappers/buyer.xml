<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd" >
<sqlMap namespace="Buyer">
<sql id="selectBuyerFrag">
	SELECT
	    BUYER_ID, BUYER_NAME, BUYER_LGU, BUYER_BANK,
	    BUYER_BANKNO, BUYER_BANKNAME, BUYER_ZIP,
	    BUYER_ADD1, BUYER_ADD2, BUYER_COMTEL,
	    BUYER_FAX, BUYER_MAIL, BUYER_CHARGER,
	    BUYER_TELEXT
	FROM
    	BUYER
</sql>
<select id="selectTotalRecord" resultClass="long" parameterClass="pagingVO">
	SELECT COUNT(*) FROM BUYER
</select>
<select id="selectBuyerList" resultClass="buyerVO" parameterClass="pagingVO">
	SELECT A.*
	FROM(
		SELECT ROWNUM RNUM, BUYER_ID, BUYER_NAME, BUYER_BANK,
		    BUYER_BANKNO, BUYER_BANKNAME
		FROM BUYER
	) A
	<![CDATA[WHERE RNUM >=#startRow# AND RNUM <= #endRow#]]>
</select>
<select id="selectBuyer" resultClass="buyerVO" parameterClass="String">
	<include refid="selectBuyerFrag"/>
	where BUYER_ID=#BUYER_ID#
</select>
<insert id="insertBuyer" parameterClass="BuyerVO">
	<selectKey resultClass="String" keyProperty="buyer_id">
		SELECT #buyer_lgu#||LPAD(NVL(TO_NUMBER(SUBSTR(MAX(BUYER_ID),1)),0 ) +1, 2, '0')
		FROM BUYER
		WHERE BUYER_LGU=#buyer_lgu#
	</selectKey>
	INSERT INTO BUYER(
	    BUYER_ID, BUYER_NAME, BUYER_LGU, BUYER_BANK,
	    BUYER_BANKNO, BUYER_BANKNAME, BUYER_ZIP,
	    BUYER_ADD1, BUYER_ADD2, BUYER_COMTEL,
	    BUYER_FAX, BUYER_MAIL, BUYER_CHARGER
	) VALUES(
		#buyer_ID#, #buyer_NAME#, #buyer_LGU#, #buyer_BANK#,
	    #buyer_BANKNO#, #buyer_BANKNAME#, #buyer_ZIP#,
	    #buyer_ADD1#, #buyer_ADD2#, #buyer_COMTEL#,
	    #buyer_FAX#, #buyer_MAIL#, #buyer_CHARGER#
	)
</insert>
</sqlMap>

